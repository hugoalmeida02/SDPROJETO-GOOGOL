<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8" />
  <title>Googol</title>
  <link rel="stylesheet" href="/static/style.css" />
  <script src="/static/index.js"></script>
  <script src="/static/websocket.js"></script>
</head>

<body>
  <header>
    <h1>Googol</h1>
  </header>

  <main>
    <form id="search-form" class="search-box">
      <input type="text" id="search-input" placeholder="Insere a palavra ou URL..." required />
      <select id="search-type">
        <option value="word">Pesquisa por palavra</option>
        <option value="backlinks">Pesquisa de backlinks</option>
      </select>
      <button type="submit">Pesquisar</button>
    </form>

    <button id="open-stats-btn">Ver estatísticas</button>

    <div id="stats-modal" class="modal">
      <div class="modal-content">
        <span class="close-btn" id="close-stats-btn">&times;</span>
        <h2>Estatísticas</h2>
        <div id="stats" class="stats-section"></div>
      </div>
    </div>
    
    <section id="add-user-stories">
      <h2>Adicionar Stories de um Utilizador</h2>
      <form id="add-user-stories-form">
        <input type="text" id="hn-user-id" placeholder="ID do Utilizador Hacker News (ex: johndoe)" required />
        <button type="submit">Adicionar Stories</button>
      </form>
      <p id="add-user-stories-msg"></p>
    </section>

  </main>
  <script>
        document
      .getElementById("search-form")
      .addEventListener("submit", function (event) {
        event.preventDefault(); // evita recarregamento
        const query = document.getElementById("search-input").value.trim();
        const type = document.getElementById("search-type").value;

        const encoded = encodeURIComponent(query);

        if (type === "word") {
          window.location.href = `/search?words=${encoded}`;
        } else {
          window.location.href = `/search-backlinks?url=${encoded}`;
        }
      });

    // Abrir e fechar modal
    document.getElementById("open-stats-btn").addEventListener("click", () => {
      document.getElementById("stats-modal").style.display = "block";
    });

    document.getElementById("close-stats-btn").addEventListener("click", () => {
      document.getElementById("stats-modal").style.display = "none";
    });

    // Fechar ao clicar fora do conteúdo do modal
    window.addEventListener("click", function (event) {
      const modal = document.getElementById("stats-modal");
      if (event.target === modal) {
        modal.style.display = "none";
      }
    });
  </script>
</body>
</html>